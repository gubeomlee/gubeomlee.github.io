---
layout: default
title: SQL
parent: SQLD
nav_order: 31
---

# SQL(Structured Query Language)

---

## SQL 소개

#### 데이터베이스의 필요성

- In-Memory: 프로그램 만든 변수의 경우 프로그램의 실행에 의존적이기 때문에 프로그램 종료 시 데이터가 사라진다. 데이터 보호가 어렵고 필요한 상황에 데이터를 불러올 수 없다는 문제가 있다.
- File I/O: 엑셀, CSV 등은 In-Memory방식보다 적절하나 여전히 한계가 있다. 데이터가 필요할 때마다 파일을 읽어야 하기 때문에 데이터의 크기가 커질수록 효율성이 떨어진다. 파일이 손상되거나 여러개 파일을 동시에 다루어야 하는 경우 데이터를 불러오는 것이 어렵다.
- SQL: 한번에 여러 테이블을 다룰 수 있어 데이터를 불러오기 수월하다. 대용량 데이터 저장에 적합하다.

#### SQL 소개

- SQL: 데이터베이스용 프로그래밍 언어다. 데이터베이스에 쿼리를 보내 원하는 데이터를 가져오거나 삽입할 수 있다. SQL은 관계형 데이터가 구조화된 테이블을 사용하는 데이터베이스에서 활용가능하다. SQL을 사용하기 위해서는 데이터의 구조가 고정되어 있어야 한다.
- NoSQL: 데이터의 구조가 고정되어 있지 않은 데이터베이스를 NoSQL이라고 한다. 관계형 데이터베이스와 달리 테이블을 사용하지 않고 데이터를 다른 형태로 저장한다.
- 쿼리: 저장된 데이터를 필터 하기 위한 질의문이다.

#### ACID

- 데이터베이스 트랜잭션이 발생했을 때 아정성을 보장할 수 있는 성질이다.
- Atomicity: 하나의 트랜잭션 내에서는 모든 연산이 성공하거나 모두 실패해야 한다.
- Consistency: 하나의 트랜잭션 전후에 데이터베이스의 일관된 상태가 유지되어야 한다.
- Isolation: 각각의 트랜재션은 독립적이며, 서로의 연산을 확인하거나 영향을 줄 수 없다.
- Durability: 하나의 성공한 트랜잭션에 대한 로그가 기록되고 영구적으로 남는다.

## SQL vs NoSQL

#### 데이터베이스 구분

- 데이터베이스는 관계형과 비관계형으로 구분된다. 이 둘은 만들어진 방식, 정보의 종류, 저장방법에 차이가 있다. 관계형 데이터베이스는 테이블의 구조와 데이터 타입 등을 사전에 정의하고 테이블에 맞는 데이터만 삽입가능하다. 관계형 데이터베이스는 테이블 간의 관계를 직관적으로 파악가능하다. NoSQL에서는 스키마에 따라 데이터를 읽어온다.

#### NoSQL

- key-value 타입
- 문서형 데이터베이스: JSON과 유사한 형식의 데이터를 문서화하여 저장한다. 각각의 문서는 하나의 속성에 대한 데이터를 가지고 있고, 컬렉션이라고 하는 그룹으로 묶어 관리한다.
- wide-column 데이터베이스: 데이터베이스 열에 대한 데이터를 집중적으로 관리한다. 각 열에는 key-value 형식으로 데이터가 저장된다. 하나의 행에 많은 열을 포함할 수 있어서 유연성이 높다. 규모가 큰 데이터 분석에 주로 이용된다.
- 그래프 데이터베이스: 노드에 속성별로 데이터를 저장하고 각 노드의 관계를 간선으로 표현한다.

#### SQL, NoSQL 차이점

- 관계형 데이터베이스는 미리 작성된 스키마(테이블)를 기반으로 데이터를 저장하나, 비관계형 다양한 스키마로 데이터를 저장한다.
- 관계형 데이터베이스는 고정된 형식의 스키마를 사용하여 이를 변경하기 위해서는 데이터베이스 전체를 수정하거나 오프라인(down-time)으로 전환해야 한다. 반면 비관계형 데이터베이스는 스키마를 동적으로 관리할 수 있고, 모든 열에 대한 데이터를 입력할 필요도 없다.
- 쿼리는 데이터베이스에 정보를 요청하는 질의문이다. 관계형 데이터베이스는 테이블의 형식과 테이블 간 관계에 맞춰 데이터를 요청해야 한다. SQL과 같은 구조화된 쿼리 언어를 사용한다. 비관계형 데이터베이스의 쿼리는 데이터 그룹 자체를 조회하는 것에 초점을 두고 있어 구조화 되지 않은 쿼리언어로 데이터 요청이 가능하다.
- 관계형 데이터베이스는 수직적으로 확장하여 비용(메모리, CPU 등)이 많이 든다. 여러 서버에 걸처 데이터베이스 관계를 정의할 수 있지만 복잡하고 비용이 많이 든다.
- 비관계형 데이터베이스는 수평적으로 확장하여 상대적으로 비용이 적게 든다.

## 관계형 데이터베이스

#### 핵심 키워드

- 데이터: 각 항목에 저장되는 값이다.
- 테이블(table, relation): 사전에 정의된 열의 데이터 타입대로 작성된 데이터가 행으로 축적된다.
- 열(column, field): 테이블의 한 열을 가르킨다.
- 레코드(record, tuple): 테이블의 한 행에 저장된 데이터다.
- 키(key): 테이블의 각 레코드를 구분할 수 있는 값이다. 레코드마다 고유한 값을 같는다. 기본키(primary key), 외래키(foreign key)가 있다.

#### 1:1 관계

- 자주 사용되지 않는다.
- 1:1 관계라면 별도 테이블을 만들 필요없이 직접 저장하는 것이 낫다.

#### 1:N 관계

- 하나의 레코드가 다른 여러개의 레코드와 연결된 경우다.
- 예시: 한명의 사용자가 여러 전화번호를 가질 수 있지만, 여러 사용자가 하나의 전화번호를 가질 수는 없다.

#### N:N 관계

- 여러 개의 레코드가 다른 테이블의 여러 개의 레코드와 관계가 있는 경우로 양방향에서 다수의 레코드를 가질 수 있다.
- Join 테이블을 만들어서 관리한다.
- 예시: 한명의 고객이 여러 여행상품을 구매할 수 있고, 하나의 여행상품을 여러 고객이 구매할 수 있다.

#### 자기참조관계

- 하나의 테이블에서 나타나는 1:N관계다. (1:N관계는 서로 다른 테이블의 관계를 나타낸다.)
