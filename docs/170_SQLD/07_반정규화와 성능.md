---
layout: default
title: 반정규화와 성능
parent: SQLD
nav_order: 7
---

# 반정규화와 성능

---

## 반정규화(역정규화)의 개념

- 데이터베이스 성능 향상을 위해 데이터 중복을 허용하고 조인을 줄이는 성능향상기법이다.
- 성능향상, 개발/운영 단순화를 위해 정규화된 데이터 모델을 중복, 통합, 분리하는 데이터 모델링 기법이다.
- 성도를 향상시키지만 데이터 모델의 유연성을 낮춘다.
- 비정규화는 정규화를 수행하지 않음을 의미한다.

## 반정규화를 수행하는 경우

- 정규화에 충실하여 종속성, 활용성은 향상되지만 수행 속도가 느려지는 경우
- 다량의 범위를 자주 처리하는 경우
- 특정 범위의 데이터만 자주 처리하는 경우
- 요약/집계 정보가 자주 요구되는 경우

## 반정규화 절차

- 반정규화 하는 경우 데이터 일관성 유지비용이 많이 발생한다.
- 대안이 없을 경우 반정규화를 수행한다.
- 반정규화 대상조사 -> 다른방법 유도 -> 반정규화

#### 반정규화 대상조상

- 대량의 범위처리 조사
- 범위처리 빈도수 조사
- 통계성 프로세스 조사
- 테이블 조인 개수 조사

#### 다른방법 유도

- 응용애플리케이션 활용: 응용 메모리 영역에서 데이터 캐시 처리
- 클러스터링 적용
- 뷰 테이블
- 인덱스의 조정

#### 반정규화 적용

- 테이블 반정규화: 테이블 병합, 분할, 추가
- 속성의 반정규화: 파생 컬럼 추가, 응용 시스템 오작동을 위한 컬럼 추가, 이력 테이블 컬럼 추가, PK에 의한 컬럼 추가, 중복 컬럼 추가
- 관계의 반정규화: 중복 관계 추가

## 반정규화 기법

- 반정규화를 적용하면 테이블을 입력, 수정, 삭제할 때 성능이 떨어지기 때문에 데이터의 무결성 유지에 주의해야 한다.

#### 테이블의 반정규화

- 테이블 병합: 1:1 관계 테이블 병합, 1:M 관계 테이블 병합, 슈퍼/서브타입 테이블 병합
- 수직분할: 열 단위에서 디스크 I/O를 분산하기 위해 테이블을 1:1로 분리하여 성능을 향상한다.
- 수평분할: 행 단위에서 디스크 I/O를 분산하고 데이터 접근 효율성 개선하기 위해 행 단위로 테이블을 분할한다.
- 중복 테이블 추가: 테이블 구조를 중복하여 원격조인을 제거한다.
- 통계 테이블 추가: SUM, AVG 등을 미리 수행하여 조회 시 성능을 향상한다.
- 이력 테이블 추가: 마스터 테이블에 존재하는 레코드를 중복한다.
- 부분 테이블 추가: 자주 사용되는 컬럼으로 별도의 반정규화 테이블을 만든다.

#### 컬럼의 반정규화

- 중복 컬럼 추가: 조인을 감소시키 위해 중복된 컬럼 생성
- 파생 컬럼 추가: 값을 미리 계산해서 컬럼에 보관
- 이력테이블 컬럼 추가: 이력테이블에 기능성 컬럼(최근값, 시작/종료 일자) 추가
- PK에 의한 컬럼 추가: 복합의미를 갖는 PK를 단일 속성으로 구성한 경우 PK안에서 특정값을 별도로 조회하는 경우 성능저하가 발생한다. PK안에 데이터가 존재하지만 성능향상을 위해 일반속성으로 포함한다.
- 응용시스템 오작동을 위한 컬럼추가: 이전 데이터를 임시로 보관한다. 컬럼으로 보관하는 방법은 임시적인 기법이지만 이것을 이력데이터 모델로 풀어내면 정상적인 데이터 모델의 기법이 된다.

#### 관계의 반정규화

- 중복 관계 추가: 데이터를 처리하기 위한 여러 경로를 거쳐 조인이 가능하지만 이 때 발생할 수 있는 성능저하를 예방하기 위해 추가적인 관계를 맺는 방법이다.
